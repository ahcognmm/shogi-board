(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{37:function(e,t,n){e.exports=n(88)},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},88:function(e,t,n){"use strict";n.r(t);var r=n(33),a=n.n(r),c=n(5),o=n(0),i=n.n(o),s=n(15),u=n.n(s),l=n(2),p=n(3),f=n(7),h=n(6),m=n(8),v=0,b=4,d=(n(42),0),w=1,O=2,y=3,k=4,j=5,g=6,E=7,x=8,C=11,S=12,N=13,T=14,R=16,P=17,M=-w,L=-O,U=-y,I=-k,A=-j,D=-g,V=-E,z=-x,F=-C,B=-S,K=-N,_=-T,W=-R,H=-P;function G(e){return e>0?e+10:e-10}function q(e){return Math.abs(e)<10?e:e<0?e+10:e-10}function J(e){if(-1===e.sourceRow)return!1;var t=e.piece!==d&&Math.abs(e.piece)!==j&&Math.abs(e.piece)<=E,n=e.piece>0?[0,1,2]:[6,7,8],r=n.includes(e.sourceRow)||n.includes(e.destRow);return t&&r}var $=["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"],Q=["\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"];function X(e){return $[e]}function Y(e){return Q[e]}function Z(e,t){var n=e.source,r=e.dest,a=e.piece,c=e.promote,o=function(e){var t=Math.abs(e);if(t===w)return"\u6b69";if(t===O)return"\u9999";if(t===y)return"\u6842";if(t===k)return"\u9280";if(t===j)return"\u91d1";if(t===g)return"\u89d2";if(t===E)return"\u98db";if(t===x)return"\u7389";if(t===C)return"\u3068";if(t===S)return"\u6210\u9999";if(t===N)return"\u6210\u6842";if(t===T)return"\u6210\u9280";if(t===R)return"\u99ac";if(t===P)return"\u9f8d";throw new Error("Failed to ident piece name. received: "+e)}(c?q(a):a),i=X(r.row),s=Y(r.column);if(-1===n.row)return"".concat(s).concat(i).concat(o,"\u6253");var u=n.row+1,l=n.column+1;return"".concat(s).concat(i).concat(o).concat(!0===c?"\u6210":!1!==c?"":!t||J({sourceRow:n.row,destRow:r.row,piece:a})?"\u4e0d\u6210":"","(").concat(l).concat(u,")")}n(43);var ee,te,ne,re,ae,ce,oe,ie,se,ue,le,pe,fe,he,me,ve=Object(c.b)("store")(ee=Object(c.c)(ee=function(e){function t(){return Object(l.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.store.engineState.result;return e?e.map(function(e){var t=e.moves.map(function(e,t){var n=Z(e,!0);return i.a.createElement("div",{key:t,className:"EngineInfoRowContent"},n)});return i.a.createElement("div",{key:e.id,className:"EngineInfoColumn"},i.a.createElement("div",{className:"EngineInfoRow EngineInfoRowContainer"},i.a.createElement("div",{className:"EngineInfoRowLabel"},"score"),i.a.createElement("div",{className:"EngineInfoRowContent Center"},e.score)),i.a.createElement("div",{className:"EngineInfoRow EngineInfoRowContainer"},i.a.createElement("div",{className:"EngineInfoRowLabel"},"\u8aad\u307f"),t))}):i.a.createElement("div",null)}}]),t}(o.Component))||ee)||ee,be=(n(44),function(e){function t(){return Object(l.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"EngineSideInfo"},i.a.createElement("div",{className:"EngineSideInfoContainer"},i.a.createElement(ve,null)))}}]),t}(o.Component)),de=1,we=2,Oe=3,ye=4,ke=(n(45),function(e){function t(){return Object(l.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.line(0,0,20,20),n=this.line(20,0,0,20);return i.a.createElement("div",{onClick:function(){return e.props.onClick()}},i.a.createElement("svg",{width:20,height:20,className:"MockupCloseButton"},t,n))}},{key:"line",value:function(e,t,n,r){return i.a.createElement("line",{x1:e,y1:t,x2:n,y2:r,stroke:"black",strokeWidth:"2"})}}]),t}(o.Component)),je=n(1),ge=n.n(je),Ee=n(9),xe=n(34),Ce=n.n(xe),Se=(n(47),n(13)),Ne=(n(48),Object(c.c)(te=function(e){function t(){return Object(l.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props.label;return i.a.createElement("button",{className:"FormButton",onClick:function(){return e.props.onClick()}},t)}}]),t}(o.Component))||te),Te=(n(49),Object(c.c)(ne=function(e){function t(){var e,n;Object(l.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).getOnClick=function(e){return Object(Ee.a)(ge.a.mark(function t(){return ge.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.props.sbclient.updateButton(e);case 2:case"end":return t.stop()}},t)}))},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props.buttons,n=Array.from(t).map(function(t){var n=Object(Se.a)(t,2),r=n[0],a=n[1],c=e.getOnClick(a);return i.a.createElement(Ne,{key:r,label:r,onClick:c})});return i.a.createElement("div",{className:"OptionButton"},n)}}]),t}(o.Component))||ne),Re=(n(50),Object(c.c)(re=function(e){function t(){return Object(l.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.label,r=t.value,a=t.name,c="FormCheck-".concat(a);return i.a.createElement("div",{className:"FormCheck"},i.a.createElement("span",null,n),i.a.createElement("div",{className:"FormCheckToggle"},i.a.createElement("input",{id:c,name:c,type:"checkbox",onChange:function(t){return e.props.onChange(t.target.checked)},checked:r}),i.a.createElement("label",{htmlFor:c},i.a.createElement("div",{className:"ToggleSwitch","data-checked":"ON","data-unchecked":"OFF"}))))}}]),t}(o.Component))||re),Pe=Object(c.c)(ae=function(e){function t(){var e,n;Object(l.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).getOnChange=function(e){return function(){var t=Object(Ee.a)(ge.a.mark(function t(r){var a;return ge.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=n.props.sbclient,e.setValue(r),a.updateCheck(e);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props.checks,n=Array.from(t).map(function(t){var n=Object(Se.a)(t,2),r=n[0],a=n[1],c=e.getOnChange(a);return i.a.createElement(Re,{key:r,label:r,name:r,value:a.value,onChange:c})});return i.a.createElement("div",null,n)}}]),t}(o.Component))||ae,Me=Object(c.c)(ce=function(e){function t(){var e,n;Object(l.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).update=function(e){var t=n.props,r=t.option,a=t.sbclient;r.setValue(e.target.value),a.updateRange(r)},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.option,t=e.name,n=e.value,r=e.inputValue,a=e.min,c=e.max,o=n.toString()===r?"FormTextInput":"FormTextInput FormTextInvalid",s="".concat(t,"(").concat(a,"~").concat(c,")");return i.a.createElement("div",{className:"FormText"},i.a.createElement("input",{className:o,type:"text",value:r,placeholder:" ",onChange:this.update,required:!0,min:a,max:c}),i.a.createElement("label",null,s))}}]),t}(o.Component))||ce,Le=Object(c.c)(oe=function(e){function t(){return Object(l.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.ranges,n=e.sbclient,r=Array.from(t).map(function(e){var t=Object(Se.a)(e,2),r=t[0],a=t[1];return i.a.createElement(Me,{key:r,option:a,sbclient:n})});return i.a.createElement("div",null,r)}}]),t}(o.Component))||oe,Ue=(n(51),Object(c.c)(ie=function(e){function t(){var e,n;Object(l.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).update=function(e){n.props.onChange(e.target.value)},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.label,n=e.value,r=e.options,a=this.renderOptions(r);return i.a.createElement("div",{className:"FormSelectContainer"},i.a.createElement("label",null,t),i.a.createElement("div",{className:"FormSelect SelectTriangle"},i.a.createElement("select",{onChange:this.update,value:n,required:!0},a)))}},{key:"renderOptions",value:function(e){return e.map(function(e,t){return i.a.createElement("option",{key:t,value:e},e)})}}]),t}(o.Component))||ie),Ie=Object(c.c)(se=function(e){function t(){var e,n;Object(l.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).getOnChange=function(e){return function(){var t=Object(Ee.a)(ge.a.mark(function t(r){var a;return ge.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=n.props.sbclient,e.setValue(r),a.updateSelect(e);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props.selects,n=Array.from(t).map(function(t){var n=Object(Se.a)(t,2),r=n[0],a=n[1],c=e.getOnChange(a);return i.a.createElement(Ue,{key:r,label:r,value:a.value,options:a.vars,onChange:c})});return i.a.createElement("div",null,n)}}]),t}(o.Component))||se,Ae=(n(52),Object(c.c)(ue=function(e){function t(){var e,n;Object(l.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).onChange=function(e){n.props.onChange(e.target.value)},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,n=e.label,r=e.allowEmpty,a=e.placeholder,c=["FormTextInput"];!0!==r&&""===t&&c.push("FormTextInvalid");var o=c.join(" ");return i.a.createElement("div",{className:"FormText"},i.a.createElement("input",{className:o,type:"text",value:t,placeholder:a||" ",onChange:this.onChange,required:!0}),i.a.createElement("label",null,n))}}]),t}(o.Component))||ue),De=Object(c.c)(le=function(e){function t(){var e,n;Object(l.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).getOnChange=function(e){return function(){var t=Object(Ee.a)(ge.a.mark(function t(r){var a;return ge.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=n.props.sbclient,e.setValue(r),a.updateText(e);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props.texts,n=Array.from(t).map(function(t){var n=Object(Se.a)(t,2),r=n[0],a=n[1],c=e.getOnChange(a);return i.a.createElement(Ae,{key:r,label:r,value:a.value,onChange:c})});return i.a.createElement("div",null,n)}}]),t}(o.Component))||le,Ve=1e3,ze=Object(c.b)("store")(pe=Object(c.c)(pe=function(e){function t(){var e,n;Object(l.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).disconnect=function(){return n.props.store.engineState.disconnect()},n.start=function(){var e=n.props.store,t=e.engineState,r=e.displayState;t.startThinking().then(function(){return r.closeMockup()}).then(n.fetchInterval).catch(function(e){return console.error(e)})},n.fetchInterval=Object(Ee.a)(ge.a.mark(function e(){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Ce()(function(){var e=Object(Ee.a)(ge.a.mark(function e(t,r){var a,c,o,i,s,u,l;return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.props.store,c=a.gameState,o=a.engineState,i=o.current,s=o.state,u=o.sbclient,i&&s===b){e.next=5;break}return r(),e.abrupt("return");case 5:return e.prev=5,e.next=8,u.getResult(c.currentMove);case 8:return l=e.sent,e.next=11,o.setResult(l);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),console.error(e.t0);case 16:case"end":return e.stop()}},e,null,[[5,13]])}));return function(t,n){return e.apply(this,arguments)}}(),Ve);case 1:case"end":return e.stop()}},e)})),n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.store.engineState,t=e.current,n=e.options,r=e.sbclient;if(!t||!n)return i.a.createElement("div",null);var a=n.buttons,c=n.checks,o=n.ranges,s=n.selects,u=n.texts,l=i.a.createElement("button",{className:"ButtonDisconnect",onClick:this.disconnect},"\u63a5\u7d9a\u89e3\u9664"),p=i.a.createElement("button",{className:"ButtonStartThinking",onClick:this.start},"\u601d\u8003\u958b\u59cb");return i.a.createElement("div",{className:"DetailContainer"},i.a.createElement("h1",{className:"EngineName"},t),l,p,i.a.createElement("h2",{className:"EngineOption"},"\u30aa\u30d7\u30b7\u30e7\u30f3"),i.a.createElement(Te,{buttons:a,sbclient:r}),i.a.createElement(Pe,{checks:c,sbclient:r}),i.a.createElement(Le,{ranges:o,sbclient:r}),i.a.createElement(Ie,{selects:s,sbclient:r}),i.a.createElement(De,{texts:u,sbclient:r}),l,p)}}]),t}(o.Component))||pe)||pe,Fe=(n(53),function(e){function t(){return Object(l.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"Loader sk-fading-circle"},i.a.createElement("div",{className:"sk-circle1 sk-circle"}),i.a.createElement("div",{className:"sk-circle2 sk-circle"}),i.a.createElement("div",{className:"sk-circle3 sk-circle"}),i.a.createElement("div",{className:"sk-circle4 sk-circle"}),i.a.createElement("div",{className:"sk-circle5 sk-circle"}),i.a.createElement("div",{className:"sk-circle6 sk-circle"}),i.a.createElement("div",{className:"sk-circle7 sk-circle"}),i.a.createElement("div",{className:"sk-circle8 sk-circle"}),i.a.createElement("div",{className:"sk-circle9 sk-circle"}),i.a.createElement("div",{className:"sk-circle10 sk-circle"}),i.a.createElement("div",{className:"sk-circle11 sk-circle"}),i.a.createElement("div",{className:"sk-circle12 sk-circle"}))}}]),t}(o.Component)),Be=(n(54),Object(c.b)("store")(fe=Object(c.c)(fe=function(e){function t(){return Object(l.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props.store.engineState,n=t.names,r=t.current,a=t.state;return 0===n.length?i.a.createElement("div",{className:"ListEngineName"},i.a.createElement("span",null,"\u5229\u7528\u53ef\u80fd\u306a\u5c06\u68cb\u30a8\u30f3\u30b8\u30f3\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093")):n.map(function(t,n){var c=t===r&&1===a?i.a.createElement(Fe,null):void 0;return i.a.createElement("div",{className:"ListEngineName",key:n,onClick:function(){return e.setCurrentEngine(t,a)}},c,i.a.createElement("span",null,t))})}},{key:"setCurrentEngine",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t,n){var r;return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n===v){e.next=2;break}return e.abrupt("return");case 2:return r=this.props.store,e.next=5,r.engineState.connect(t);case 5:return e.next=7,r.updatePosition().catch(function(e){return console.error(e)});case 7:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"componentWillMount",value:function(){var e=this.props.store.engineState;e.sbclient.init().then(function(t){return e.setNames(t)}).catch(function(t){var n=["\u63a5\u7d9a\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u4ee5\u4e0b\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002","1. \u30b5\u30fc\u30d0\u30fc\u304c\u8d77\u52d5\u3057\u3066\u3044\u308b\u304b","2. \u30b5\u30fc\u30d0\u30fc\u306eURL\u304c\u6b63\u3057\u3044\u304b","3. \u30b5\u30fc\u30d0\u30fc\u306e\u30ed\u30b0\u3092\u78ba\u8a8d\u3057\u3001\u30a8\u30e9\u30fc\u7b49\u304c\u51fa\u3066\u3044\u306a\u3044\u304b","4. \u30b5\u30fc\u30d0\u30fc\u3067\u5c06\u68cb\u30a8\u30f3\u30b8\u30f3\u306e\u5b9f\u884c\u30d1\u30b9\u3092\u8a2d\u5b9a\u3057\u305f\u304b","5. \u5c06\u68cb\u30a8\u30f3\u30b8\u30f3\u304c\u5b9f\u884c\u53ef\u80fd\u3067\u3042\u308b\u304b"].join("\n");console.error(t),e.disconnect(),alert(n)})}}]),t}(o.Component))||fe)||fe),Ke=Object(c.b)("store")(he=Object(c.c)(he=function(e){function t(){var e,n;Object(l.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).close=function(){return n.props.store.displayState.setMockupState(de)},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.store.engineState.state,t=e===v||1===e?i.a.createElement(Be,null):i.a.createElement(ze,null);return i.a.createElement("div",{className:"Mockup"},i.a.createElement(ke,{onClick:this.close}),t)}}]),t}(o.Component))||he)||he,_e=Object(c.b)("store")(me=Object(c.c)(me=function(e){function t(){var e,n;Object(l.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).close=function(){return n.props.store.displayState.setMockupState(de)},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.store.config,t=e.paintTargets,n=e.serverURL,r=e.saveToCookie;return i.a.createElement("div",{className:"Mockup"},i.a.createElement(ke,{onClick:this.close}),i.a.createElement("h1",null,"\u8a2d\u5b9a"),i.a.createElement(Ae,{label:"shogi-board-server \u306e URL",value:n,allowEmpty:!0,onChange:function(t){return e.setServerURL(t)},placeholder:"(\u4f8b)http://localhost:8080"}),i.a.createElement(Re,{label:"\u99d2\u304c\u79fb\u884c\u3067\u304d\u308b\u30de\u30b9\u306b\u8272\u3092\u4ed8\u3051\u308b",value:t,name:"PaintTargets",onChange:function(t){return e.setPaintTargets(t)}}),i.a.createElement(Re,{label:"Cookie \u306b\u8a2d\u5b9a\u3092\u4fdd\u5b58\u3059\u308b",value:r,name:"SaveToCookie",onChange:function(t){return e.setSaveToCookie(t)}}))}}]),t}(o.Component))||me)||me;n(55);function We(e,t){return e.row-t.row||e.column-t.column}function He(e,t){for(var n=e.length>>1,r=0,a=e.length-1;r<=a;){if(e[n].row===t.row&&e[n].column===t.column)return n;e[n].row<t.row?r=n+1:e[n].row>t.row?a=n-1:e[n].column<t.column?r=n+1:a=n-1,n=r+(a-r>>1)}return-1}var Ge,qe,Je=1,$e=-1,Qe=(n(56),Object(c.b)("store")(Ge=Object(c.c)(Ge=function(e){function t(){var e,n;Object(l.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).getPiece=function(){var e=n.props,t=e.row,r=e.column,a=e.store;return Xe(t)&&Xe(r)?a.gameState.currentMove.pos.pos[t][r]:d},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.row,r=t.column,a=t.store,c=a.config,o=a.gameState,s=o.indexes,u=o.selected,l=o.confirm,p=o.currentMove,f=o.moveTargets,h=this.getPiece(),m=p.pos.turn,v=h>0&&m===Je||h<0&&m===$e,b=c.paintTargets&&-1!==He(f,{row:n,column:r}),w=function(e){e.confirm&&e.sel&&(e.r===e.sel.row&&e.c===e.sel.column||e.r===e.confirm.row&&e.c===e.confirm.column)&&(e.p=d);var t=Xe(e.r),n=Xe(e.c),r=t&&(!e.rv&&8===e.c||e.rv&&0===e.c),a=n&&(!e.rv&&0===e.r||e.rv&&8===e.r),c=!e.rv&&(2===e.r&&6===e.c||2===e.r&&3===e.c||5===e.r&&6===e.c||5===e.r&&3===e.c)||e.rv&&(6===e.r&&2===e.c||6===e.r&&5===e.c||3===e.r&&2===e.c||3===e.r&&5===e.c),o=t&&n&&!!e.sel&&e.sel.row===e.r&&e.sel.column===e.c,i=t&&n?"Piece Piece-Bordered ":"",s=e.p&&e.rv?-1*e.p:e.p,u=s?"Piece-".concat(s," "):"",l=e.isTurn?"Piece-Turn ":"",p=o?"Piece-Selected ":"",f=e.isTargeted?"Piece-Targeted ":"",h=r?"Piece-Left ":"",m=a?"Piece-Top ":"",v=-1===e.c&&t||-1===e.r&&n?"Cell-EdgeText ":"",b=c?"Piece-Star":"";return"Cell ".concat(i).concat(u).concat(l).concat(p).concat(f).concat(h).concat(m).concat(v).concat(b)}({r:n,c:r,rv:9===s[0],p:h,sel:u,confirm:l,isTurn:v,isTargeted:b});return i.a.createElement("div",{className:w,onClick:function(){return e.click()}},this.renderConfirm(l),this.renderEdgeTextRow(),this.renderEdgeTextColumn())}},{key:"renderConfirm",value:function(e){var t=this,n=this.props,r=n.row,a=n.column,c=n.store;if(e&&e.row===r&&e.column===a){var o=9===c.gameState.indexes[0],s=o&&e.preserved>0||!o&&e.preserved<0,u="Piece-Confirm Piece-Confirm"+Number(s);return i.a.createElement("div",{className:u},i.a.createElement("div",{className:"Piece-Confirm-Promote",onClick:function(){return t.click(e,!0)}}),i.a.createElement("div",{className:"Piece-Confirm-Preserve",onClick:function(){return t.click(e)}}))}}},{key:"renderEdgeTextRow",value:function(){var e=this.props,t=e.row,n=e.column;if(Xe(n)&&-1===t)return i.a.createElement("span",null,Y(n))}},{key:"renderEdgeTextColumn",value:function(){var e=this.props,t=e.row,n=e.column;if(Xe(t)&&-1===n)return i.a.createElement("span",null,X(t))}},{key:"click",value:function(e,t){var n=this.props,r=n.row,a=n.column,c=n.store;if(!c.gameState.confirm||e){var o={clicked:e||this.getPiece(),row:r,column:a,promote:t};c.gameState.clickPiece(o)}}}]),t}(o.Component))||Ge)||Ge);function Xe(e){return 0<=e&&e<=8}var Ye=Object(c.b)("store")(qe=Object(c.c)(qe=function(e){function t(){return Object(l.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.store.gameState.indexes,t=e.map(function(t){return e.slice().reverse().map(function(e){return i.a.createElement(Qe,{key:10*t+e,row:t,column:e})})});return i.a.createElement("div",{className:"BoardContainer"},i.a.createElement("div",{className:"ResetPseudo"},i.a.createElement("div",{className:"Board"},t),this.renderMockup()))}},{key:"renderMockup",value:function(){var e=this.props.store.displayState.mockup;return e===we?i.a.createElement(Ke,null):e===ye||e===Oe?i.a.createElement(_e,null):void 0}}]),t}(o.Component))||qe)||qe;n(57);function Ze(e){return"branches"in e}function et(e){return e.history.moves.length<1?"":function e(t){return t.moves.map(function(t){return Ze(t)?e(t.branches[t.index]):"".concat(t.index," ").concat(t.str)}).join("\n")}({moves:e.history.moves.slice(1),index:e.history.index})}n(58);var tt,nt,rt=Object(c.b)("store")(tt=Object(c.c)(tt=function(e){function t(){var e,n;Object(l.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).reverse=function(){return n.props.store.gameState.reverse()},n.kifHandler=function(e){return function(){return n.props.store.gameState.clickKif(e)}},n.engineOnClick=Object(Ee.a)(ge.a.mark(function e(){var t,r,a,c;return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props.store,r=t.engineState,a=r.current,c=r.state,a&&c===b){e.next=6;break}return e.next=5,n.connectToEngine();case 5:return e.abrupt("return",e.sent);case 6:return e.next=8,r.stopThinking();case 8:case"end":return e.stop()}},e)})),n.connectToEngine=Object(Ee.a)(ge.a.mark(function e(){var t,r;return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props.store,r=t.displayState,""!==t.config.serverURL){e.next=6;break}return console.log("here"),e.next=5,r.setMockupState(Oe);case 5:return e.abrupt("return",e.sent);case 6:return e.next=8,r.setMockupState(we);case 8:case"end":return e.stop()}},e)})),n.showSetting=Object(Ee.a)(ge.a.mark(function e(){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.props.store.displayState.setMockupState(ye));case 1:case"end":return e.stop()}},e)})),n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.store,t=e.gameState,n=e.engineState,r=t.currentMove,a=t.kif,c=r.index,o=n.state===b?"\u601d\u8003\u505c\u6b62":"\u5c06\u68cb\u30a8\u30f3\u30b8\u30f3",s=c-1<0?0:c-1,u=c+1,l=c-5<0?0:c-5,p=c+5;return i.a.createElement("div",{className:"ButtonsContainer"},i.a.createElement("button",{className:"PrevOne",onClick:this.kifHandler(s)},"\uff1c"),i.a.createElement("button",{className:"NextOne",onClick:this.kifHandler(u)},"\uff1e"),i.a.createElement("button",{className:"PrevFive",onClick:this.kifHandler(l)},"\uff1c 5"),i.a.createElement("button",{className:"NextFive",onClick:this.kifHandler(p)},"5 \uff1e"),i.a.createElement("button",{className:"Reverse",onClick:this.reverse},"\u76e4\u9762\u53cd\u8ee2"),i.a.createElement("button",{className:"Copy","data-clipboard-text":et(a)},"\u68cb\u8b5c\u30b3\u30d4\u30fc"),i.a.createElement("button",{className:"ConnectToEngine",onClick:this.engineOnClick},o),i.a.createElement("button",{className:"Configuration",onClick:this.showSetting},"\u8a2d\u5b9a"))}}]),t}(o.Component))||tt)||tt,at=(n(59),Object(c.b)("store")(nt=Object(c.c)(nt=function(e){function t(){return Object(l.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.captures,n=e.isLeftSide,r="Captures Captures"+Number(n);return i.a.createElement("div",{className:r},this.cells("Hisha",E,t[6]),this.cells("Kaku",g,t[5]),this.cells("Kin",j,t[4]),this.cells("Gin",k,t[3]),this.cells("Kei",y,t[2]),this.cells("Kyou",O,t[1]),this.cells("Fu",w,t[0]))}},{key:"cells",value:function(e,t,n){var r=this.props,a=r.store,c=r.isTurn,o=r.isLeftSide,s=a.gameState.selected,u=a.gameState.currentMove.pos.turn,l=Array.from(Array(n).keys()).map(function(r){var l=c?function(e,t,n){return e&&e.piece&&-1===e.row&&-1===e.column&&Math.abs(e.piece)===t&&e.i===n?"Piece-Selected":""}(s,t,r):"",p=c?"Piece-Turn":"",f=o?-t:t,h=Number(o),m="Capture-".concat(t).concat(h).concat(n).concat(r+1),v="Piece Piece-".concat(f," ").concat(p," ").concat(l," ").concat(m),b="Cap-".concat(h,"-").concat(e,"-").concat(r);return i.a.createElement("div",{key:b,className:v,onClick:function(){if(c){var e=u*t;a.gameState.clickPiece({clicked:e,row:-1,column:-1,i:r})}}})}),p="Captures-Inner Captures-".concat(e);return i.a.createElement("div",{className:p},l)}}]),t}(o.Component))||nt)||nt);n(60);var ct,ot=Object(c.b)("store")(ct=Object(c.c)(ct=function(e){function t(){return Object(l.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.store.gameState,t=e.indexes,n=e.currentMove.pos,r=n.turn,a=n.cap0,c=n.cap1,o=-1===t[0]?c:a,s=-1===t[0]?r===$e:r===Je;return i.a.createElement("div",{className:"LeftSide"},i.a.createElement(at,{isLeftSide:!0,captures:o,isTurn:s}),i.a.createElement("div",{className:"LeftInfo"},i.a.createElement("div",null),i.a.createElement(rt,null)))}}]),t}(o.Component))||ct)||ct,it=n(36);n(61);var st,ut,lt,pt=Object(c.b)("store")(st=Object(c.c)(st=function(e){function t(){return Object(l.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.store.gameState.kif.history.moves,t=this.renderKif(e,0);return i.a.createElement("div",{className:"KifContainer"},i.a.createElement("div",{className:"Kif-Inner"},t))}},{key:"renderKif",value:function(e,t){var n=this,r=e.map(function(e,r){return Ze(e)?n.renderBranch(e,t+r):n.renderMove(e,t+r)});return Array.prototype.concat.apply([],r)}},{key:"renderBranch",value:function(e,t){for(var n=this,r=e.branches[e.index],a=Object(it.a)(r.moves),c=a[0],o=a.slice(1),s=[],u=function(r){if(r===e.index)return"continue";var a=e.branches[r].moves[0],c="".concat(t,"-").concat(r),o="-- ".concat(a.str);s.push(i.a.createElement("div",{key:c,className:"Branch",onClick:function(){return n.props.store.gameState.clickKif(t,r)}},i.a.createElement("span",null,o)))},l=0;l<e.branches.length;l++)u(l);var p=0!==o.length?this.renderKif(o,t+1):[];return[this.renderMove(c,t)].concat(s).concat(p)}},{key:"renderMove",value:function(e,t){var n=this,r=this.props.store.gameState.currentMove.index===t?"Move-Current":void 0;return i.a.createElement("div",{key:t,className:"Move",id:r,onClick:function(){return n.props.store.gameState.clickKif(t)}},i.a.createElement("div",{className:"Number code"},t+"."),i.a.createElement("div",{className:"MoveText"},e.str))}},{key:"componentDidUpdate",value:function(){!function(e){var t=document.getElementById(e);t&&t.scrollIntoViewIfNeeded()}("Move-Current")}}]),t}(o.Component))||st)||st,ft=(n(62),Object(c.b)("store")(ut=Object(c.c)(ut=function(e){function t(){return Object(l.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.store.gameState,t=e.indexes,n=e.currentMove.pos,r=n.turn,a=n.cap0,c=n.cap1,o=9===t[0]?c:a,s=9===t[0]?r===$e:r===Je;return i.a.createElement("div",{className:"RightSide"},i.a.createElement("div",{className:"RightInfo"},i.a.createElement(pt,null)),i.a.createElement(at,{isLeftSide:!1,captures:o,isTurn:s}))}}]),t}(o.Component))||ut)||ut),ht=function(e){function t(){return Object(l.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"BoardArea"},i.a.createElement(ot,null),i.a.createElement(Ye,null),i.a.createElement(ft,null))}}]),t}(o.Component),mt=Object(c.b)("store")(lt=Object(c.c)(lt=function(e){function t(){return Object(l.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.store.engineState.state===b,t=this.renderEngineInfo(e),n=e?"App App-SideInfo":"App App-BoardOnly";return i.a.createElement("div",{className:n},i.a.createElement(ht,null),t)}},{key:"renderEngineInfo",value:function(e){if(e)return i.a.createElement(be,null)}}]),t}(o.Component))||lt)||lt,vt=(n(63),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function bt(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var dt,wt,Ot,yt,kt,jt,gt,Et,xt,Ct,St,Nt,Tt,Rt,Pt,Mt=n(11),Lt=n(10),Ut=(n(16),n(4)),It=n(14),At=n.n(It),Dt=(dt=function(){function e(){Object(l.a)(this,e),Object(Mt.a)(this,"paintTargets",wt,this),Object(Mt.a)(this,"serverURL",Ot,this),Object(Mt.a)(this,"saveToCookie",yt,this),this.keys={paintTargets:"paintTargets",serverURL:"serverURL",saveToCookie:"saveToCookie"},this.expire={expires:31536e3},this.paintTargets=!("false"===At.a.get(this.keys.paintTargets)),this.serverURL=At.a.get(this.keys.serverURL)||"",this.saveToCookie="true"===At.a.get(this.keys.saveToCookie)}return Object(p.a)(e,[{key:"setPaintTargets",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.paintTargets=t,this.saveToCookie&&At.a.set(this.keys.paintTargets,String(t),this.expire);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setServerURL",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.serverURL=t,this.saveToCookie&&At.a.set(this.keys.serverURL,t,this.expire);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setSaveToCookie",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.saveToCookie=t,!this.saveToCookie){e.next=3;break}return e.abrupt("return",At.a.set(this.keys.saveToCookie,String(t),this.expire));case 3:Object.values(this.keys).forEach(function(e){return At.a.remove(e)});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}(),wt=Object(Lt.a)(dt.prototype,"paintTargets",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ot=Object(Lt.a)(dt.prototype,"serverURL",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yt=Object(Lt.a)(dt.prototype,"saveToCookie",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(Lt.a)(dt.prototype,"setPaintTargets",[Ut.d],Object.getOwnPropertyDescriptor(dt.prototype,"setPaintTargets"),dt.prototype),Object(Lt.a)(dt.prototype,"setServerURL",[Ut.d],Object.getOwnPropertyDescriptor(dt.prototype,"setServerURL"),dt.prototype),Object(Lt.a)(dt.prototype,"setSaveToCookie",[Ut.d],Object.getOwnPropertyDescriptor(dt.prototype,"setSaveToCookie"),dt.prototype),dt),Vt=(kt=function(){function e(){Object(l.a)(this,e),Object(Mt.a)(this,"mockup",jt,this),this.mockup=de}return Object(p.a)(e,[{key:"setMockupState",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.mockup=t;case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"closeMockup",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.mockup=de;case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),jt=Object(Lt.a)(kt.prototype,"mockup",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(Lt.a)(kt.prototype,"setMockupState",[Ut.d],Object.getOwnPropertyDescriptor(kt.prototype,"setMockupState"),kt.prototype),Object(Lt.a)(kt.prototype,"closeMockup",[Ut.d],Object.getOwnPropertyDescriptor(kt.prototype,"closeMockup"),kt.prototype),kt),zt=n(20),Ft=n.n(zt),Bt=n(22),Kt=n.n(Bt),_t=n(35),Wt=n.n(_t);function Ht(e,t,n){if(t===x||t===z||t>10)throw new Error("Piece ID of Captures must not be Gyoku or over 10.");return e.map(function(e,r){if(r!==t-1)return e;var a=n(e);if(a<0)throw new Error("Invalid function call. Captures must not contain negative value.");return a})}function Gt(e){var t=function(t,n){if(e.pos.turn!==n)return t.slice();var r=e.pos.pos[e.dest.row][e.dest.column];return r*n<0?function(e,t){return Ht(e,Math.abs(t),function(e){return e+1})}(t,q(r)):-1===e.source.row&&-1===e.source.column?function(e,t){return Ht(e,Math.abs(t),function(e){return e-1})}(t,e.piece):t.slice()},n=t(e.pos.cap0,Je),r=t(e.pos.cap1,$e);return{pos:Jt(e),cap0:n,cap1:r,turn:-e.pos.turn,moveCount:e.pos.moveCount+1}}function qt(e){return{pos:Jt(e),cap0:e.pos.cap0.slice(),cap1:e.pos.cap1.slice(),turn:-e.pos.turn,moveCount:e.pos.moveCount+1}}function Jt(e){return e.pos.pos.map(function(t,n){return t.map(function(t,r){return e.source.row===n&&e.source.column===r?d:e.dest.row===n&&e.dest.column===r?e.piece:t})})}var $t,Qt,Xt,Yt,Zt,en,tn,nn=function(){function e(t){Object(l.a)(this,e),this.name=void 0,this.name=t}return Object(p.a)(e,[{key:"setValue",value:function(e){}}]),e}(),rn=(gt=function(){function e(t,n,r){Object(l.a)(this,e),Object(Mt.a)(this,"value",Et,this),this.name=void 0,this.default=void 0,this.name=t,this.value=n,this.default=r}return Object(p.a)(e,[{key:"setValue",value:function(e){this.value=e}}]),e}(),Et=Object(Lt.a)(gt.prototype,"value",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(Lt.a)(gt.prototype,"setValue",[Ut.d],Object.getOwnPropertyDescriptor(gt.prototype,"setValue"),gt.prototype),gt),an=(xt=function(){function e(t,n,r,a,c){Object(l.a)(this,e),Object(Mt.a)(this,"value",Ct,this),Object(Mt.a)(this,"inputValue",St,this),this.name=void 0,this.default=void 0,this.min=void 0,this.max=void 0,this.name=t,this.value=n,this.inputValue=n.toString(),this.default=r,this.min=a,this.max=c}return Object(p.a)(e,[{key:"setValue",value:function(e){this.inputValue=e;var t=Number(this.inputValue);Number.isNaN(t)||t<this.min||t>this.max||(this.value=t)}}]),e}(),Ct=Object(Lt.a)(xt.prototype,"value",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),St=Object(Lt.a)(xt.prototype,"inputValue",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(Lt.a)(xt.prototype,"setValue",[Ut.d],Object.getOwnPropertyDescriptor(xt.prototype,"setValue"),xt.prototype),xt),cn=(Nt=function(){function e(t,n,r,a){Object(l.a)(this,e),Object(Mt.a)(this,"value",Tt,this),this.name=void 0,this.default=void 0,this.vars=void 0,this.name=t,this.value=n,this.default=r,this.vars=a}return Object(p.a)(e,[{key:"setValue",value:function(e){this.value=e}}]),e}(),Tt=Object(Lt.a)(Nt.prototype,"value",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(Lt.a)(Nt.prototype,"setValue",[Ut.d],Object.getOwnPropertyDescriptor(Nt.prototype,"setValue"),Nt.prototype),Nt),on=(Rt=function(){function e(t,n,r){Object(l.a)(this,e),Object(Mt.a)(this,"value",Pt,this),this.name=void 0,this.default=void 0,this.name=t,this.value=n,this.default=r}return Object(p.a)(e,[{key:"setValue",value:function(e){this.value=e}}]),e}(),Pt=Object(Lt.a)(Rt.prototype,"value",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(Lt.a)(Rt.prototype,"setValue",[Ut.d],Object.getOwnPropertyDescriptor(Rt.prototype,"setValue"),Rt.prototype),Rt),sn=1e3,un=function(){function e(t,n){var r=this;Object(l.a)(this,e),this._engineName=void 0,this._serverURL=void 0,this.engineNameKey="key",this.updateRange=Kt()(function(){var e=Object(Ee.a)(ge.a.mark(function e(t){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.post("options/update/range",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),sn),this.updateText=Kt()(function(){var e=Object(Ee.a)(ge.a.mark(function e(t){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.post("options/update/text",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),sn),this._engineName=t,this._serverURL=n}return Object(p.a)(e,[{key:"init",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(){var t,n;return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.buildUrl("init",!1);case 2:return t=e.sent,e.next=5,Ft.a.post(t);case 5:return n=e.sent,e.abrupt("return",n.data);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"connect",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("connect");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("close");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("start");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("stop");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getOptions",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(){var t,n;return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("options/get");case 2:return t=e.sent,n={buttons:new Map,checks:new Map,ranges:new Map,selects:new Map,texts:new Map},Object.values(t.buttons).forEach(function(e){return n.buttons.set(e.name,new nn(e.name))}),Object.values(t.checks).forEach(function(e){return n.checks.set(e.name,new rn(e.name,e.value,e.default))}),Object.values(t.ranges).forEach(function(e){return n.ranges.set(e.name,new an(e.name,e.value,e.default,e.min,e.max))}),Object.values(t.selects).forEach(function(e){return n.selects.set(e.name,new cn(e.name,e.value,e.default,e.vars))}),Object.values(t.texts).forEach(function(e){return n.texts.set(e.name,new on(e.name,e.value,e.default))}),e.abrupt("return",n);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"updateButton",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("options/update/button",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateCheck",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("options/update/check",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateSelect",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("options/update/select",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getResult",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t){var n,r;return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("result/get");case 2:return n=e.sent,r=t.pos,e.abrupt("return",Object.entries(n).sort(function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0}).map(function(e){var n=Object(Se.a)(e,2),a=(n[0],n[1]),c=0;r=t.pos;var o=[];try{for(;c<a.moves.length;){var i=a.moves[c],s={row:i.source.row,column:i.source.column},u={row:i.dest.row,column:i.dest.column},l=i.pieceId||r.pos[s.row][s.column];if(l===d)break;var p={pos:r,source:s,dest:u,piece:l,promote:i.isPromoted};o.push(p),r=Gt(p),c=c+1|0}}catch(h){}var f=new Map;return Object.entries(a.values).forEach(function(e){var t=Object(Se.a)(e,2),n=t[0],r=t[1];return f.set(n,r)}),{id:Wt.a.generate(),values:f,score:a.score,moves:o}}));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setPosition",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t){var n;return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={pos:t.pos.map(function(e){return e.slice().reverse()}),cap0:t.cap0,cap1:t.cap1,turn:t.turn,moveCount:t.moveCount},e.next=3,this.post("position/set",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t){var n,r;return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.buildUrl(t,!0);case 2:return n=e.sent,e.next=5,Ft.a.get(n);case 5:return r=e.sent,e.abrupt("return",r.data);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t,n){var r;return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.buildUrl(t,!0);case 2:return r=e.sent,e.next=5,Ft.a.post(r,n,{headers:{"Content-Type":"application/json"}});case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"buildUrl",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t,n){var r,a;return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(e){return encodeURIComponent(e)},a=n?"?".concat(this.engineNameKey,"=").concat(r(this.engineName)):"",e.abrupt("return","".concat(this.serverURL,"/").concat(t).concat(a));case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"e",value:function(e){return encodeURIComponent(e)}},{key:"engineName",set:function(e){this._engineName=e},get:function(){if(!this._engineName)throw new Error("engineName is not defined.");return this._engineName}},{key:"serverURL",set:function(e){this._serverURL=e},get:function(){if(!this._serverURL)throw new Error("serverURL is not defined. serverURL");return this._serverURL}}]),e}(),ln=($t=function(){function e(){Object(l.a)(this,e),Object(Mt.a)(this,"names",Qt,this),Object(Mt.a)(this,"current",Xt,this),Object(Mt.a)(this,"options",Yt,this),Object(Mt.a)(this,"state",Zt,this),Object(Mt.a)(this,"result",en,this),Object(Mt.a)(this,"serverURL",tn,this),this.names=[],this.current=null,this.options=null,this.state=v,this.result=null,this.serverURL=""}return Object(p.a)(e,[{key:"setNames",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.names=t;case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setState",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.state=t;case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"connect",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.names.includes(t)){e.next=2;break}throw new Error("Unknown engine name. name="+t);case 2:return this.current=t,e.prev=3,this.setState(1),e.next=7,this.sbclient.connect();case 7:return e.next=9,this.sbclient.getOptions();case 9:this.options=e.sent,this.setState(2),e.next=19;break;case 13:return e.prev=13,e.t0=e.catch(3),console.error("Failed to connect",e.t0),alert("\u63a5\u7d9a\u306b\u5931\u6557\u3057\u307e\u3057\u305f"),e.next=19,this.disconnect();case 19:case"end":return e.stop()}},e,this,[[3,13]])}));return function(t){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.sbclient.close();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("\u63a5\u7d9a\u89e3\u9664\u306b\u5931\u6557\u3057\u307e\u3057\u305f",e.t0);case 8:return e.prev=8,this.current=null,this.options=null,this.state=v,e.finish(8);case 13:case"end":return e.stop()}},e,this,[[0,5,8,13]])}));return function(){return e.apply(this,arguments)}}()},{key:"startThinking",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.current){e.next=2;break}throw new Error("[startThinking] current engine is not set");case 2:return e.next=4,this.sbclient.start();case 4:return e.next=6,this.setState(b);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"stopThinking",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.current){e.next=2;break}throw new Error("[stopThinking] current engine is not set");case 2:if(this.state===b){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.sbclient.stop();case 6:return e.next=8,this.setState(3);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setResult",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.result=t;case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updatePosition",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sbclient.setPosition(t);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setServerURL",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.serverURL=t;case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"sbclient",get:function(){return new un(this.current||"",this.serverURL)}}]),e}(),Qt=Object(Lt.a)($t.prototype,"names",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xt=Object(Lt.a)($t.prototype,"current",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yt=Object(Lt.a)($t.prototype,"options",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zt=Object(Lt.a)($t.prototype,"state",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),en=Object(Lt.a)($t.prototype,"result",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tn=Object(Lt.a)($t.prototype,"serverURL",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(Lt.a)($t.prototype,"sbclient",[Ut.e],Object.getOwnPropertyDescriptor($t.prototype,"sbclient"),$t.prototype),Object(Lt.a)($t.prototype,"setNames",[Ut.d],Object.getOwnPropertyDescriptor($t.prototype,"setNames"),$t.prototype),Object(Lt.a)($t.prototype,"setState",[Ut.d],Object.getOwnPropertyDescriptor($t.prototype,"setState"),$t.prototype),Object(Lt.a)($t.prototype,"connect",[Ut.d],Object.getOwnPropertyDescriptor($t.prototype,"connect"),$t.prototype),Object(Lt.a)($t.prototype,"disconnect",[Ut.d],Object.getOwnPropertyDescriptor($t.prototype,"disconnect"),$t.prototype),Object(Lt.a)($t.prototype,"startThinking",[Ut.d],Object.getOwnPropertyDescriptor($t.prototype,"startThinking"),$t.prototype),Object(Lt.a)($t.prototype,"stopThinking",[Ut.d],Object.getOwnPropertyDescriptor($t.prototype,"stopThinking"),$t.prototype),Object(Lt.a)($t.prototype,"setResult",[Ut.d],Object.getOwnPropertyDescriptor($t.prototype,"setResult"),$t.prototype),Object(Lt.a)($t.prototype,"setServerURL",[Ut.d],Object.getOwnPropertyDescriptor($t.prototype,"setServerURL"),$t.prototype),$t);function pn(e,t,n){var r=e.moves.length-1,a=e.moves[r],c=e.moves.slice(0,r),o=t<=r?0:t-r;return{moves:Ze(a)?c.concat(function(e,t,n){var r=0===t&&void 0!==n?n:e.index;return 0===t?{branches:e.branches.map(function(e){return pn(e,0)}),index:r}:{branches:e.branches.map(function(r,a){return a===e.index?pn(r,t,n):r}),index:r}}(a,o,n)):e.moves.slice(),index:t<=r?t:r}}function fn(e,t){var n=e.index===e.moves.length-1,r=e.moves[e.index];if(n&&Ze(r))return{moves:e.moves.slice(0,e.moves.length-1).concat(hn(r,t,!0)),index:e.index};var a=e.index+1;if(n)return{moves:e.moves.concat(t),index:a};var c=e.moves[a],o=e.moves.slice(0,a);if(Ze(c))return{moves:o.concat(hn(c,t,!1)),index:a};if(bn(t,c))return{moves:e.moves.slice(),index:a};var i=e.moves.slice(a,e.moves.length);return{moves:o.concat(mn(i,t)),index:a}}function hn(e,t,n){if(n)return{branches:e.branches.map(function(n,r){return r===e.index?fn(n,t):n}),index:e.index};var r=e.branches.findIndex(function(e){return bn(e.moves[0],t)});return-1!==r?{branches:e.branches.slice(),index:r}:{branches:e.branches.concat(vn([t])),index:e.branches.length}}function mn(e,t){return{branches:[vn(e),vn([t])],index:1}}function vn(e){return{moves:e,index:0}}function bn(e,t){return e.index===t.index&&e.source.row===t.source.row&&e.source.column===t.source.column&&e.dest.row===t.dest.row&&e.dest.column===t.dest.column&&e.piece===t.piece&&e.promote===t.promote}var dn,wn,On,yn,kn,jn,gn=function(e,t,n){for(var r=[],a=0;a<9;a++)if(!t||!t.includes(a))for(var c=0;c<9;c++){n&&n.includes(c)||e[a][c]!==d||r.push({row:a,column:c})}return r},En=function(e,t,n){for(var r=[],a=0;a<t.length;a++){var c=t[a][0],o=t[a][1];c>=0&&c<=8&&o>=0&&o<=8&&e[c][o]*n<=0&&r.push({row:c,column:o})}return r},xn=function(e,t,n,r,a,c,o){for(;0<=t&&t<=8&&0<=n&&n<=8;){var i=e[t][n];if(i*r>0)break;if(a.push({row:t,column:n}),i*r<0)break;t+=c,n+=o}},Cn=function(e,t){if(!t.piece||t.piece!==E&&t.piece!==V)throw new Error("Called validation for hisha, but piece id was not hisha.");if(-1===t.row&&-1===t.column)return gn(e.pos);for(var n=[[-1,0],[0,-1],[0,1],[1,0]],r=[],a=0;a<n.length;a++)xn(e.pos,t.row+n[a][0],t.column+n[a][1],t.piece,r,n[a][0],n[a][1]);return r.sort(We),r},Sn=function(e,t){if(!t.piece||t.piece!==g&&t.piece!==D)throw new Error("Called validation for kaku, but piece id was not kaku.");if(-1===t.row&&-1===t.column)return gn(e.pos);for(var n=[[-1,-1],[-1,1],[1,-1],[1,1]],r=[],a=0;a<n.length;a++)xn(e.pos,t.row+n[a][0],t.column+n[a][1],t.piece,r,n[a][0],n[a][1]);return r.sort(We),r},Nn=function(e,t){var n=t.piece;if(n===d)throw new Error("Cannot get targets to move for empty cell.");if(n===w||n===M)return function(e,t){if(!t.piece||t.piece!==w&&t.piece!==M)throw new Error("Called validation for fu, but piece id was not fu.");for(var n=[],r=0;r<9;r++)for(var a=0;a<9;a++)if(e.pos[a][r]===t.piece){n.push(r);break}if(-1===t.row&&-1===t.column){var c=t.piece>0?0:8;return gn(e.pos,[c],n)}var o=t.piece>0?t.row-1:t.row+1;return o<0||o>8||e.pos[o][t.column]*t.piece>0?[]:[{row:o,column:t.column}]}(e,t);if(n===O||n===L)return function(e,t){if(!t.piece||t.piece!==O&&t.piece!==L)throw new Error("Called validation for kyou, but piece id was not kyou.");if(-1===t.row&&-1===t.column){var n=t.piece>0?0:8;return gn(e.pos,[n])}var r=t.piece>0?-1:1,a=[];return xn(e.pos,t.row+r,t.column,t.piece,a,r,0),t.piece>0&&a.reverse(),a}(e,t);if(n===y||n===U)return function(e,t){if(!t.piece||t.piece!==y&&t.piece!==U)throw new Error("Called validation for kei, but piece id was not kei.");if(-1===t.row&&-1===t.column){var n=t.piece>0?0:8,r=t.piece>0?n+1:n-1;return gn(e.pos,[n,r])}var a=t.piece>0?t.row-2:t.row+2;if(a<0||a>8)return[];var c=[[a,t.column-1],[a,t.column+1]];return En(e.pos,c,t.piece)}(e,t);if(n===k||n===I)return function(e,t){if(!t.piece||t.piece!==k&&t.piece!==I)throw new Error("Called validation for gin, but piece id was not gin.");if(-1===t.row&&-1===t.column)return gn(e.pos);var n=t.piece>0?[[t.row-1,t.column-1],[t.row-1,t.column],[t.row-1,t.column+1],[t.row+1,t.column-1],[t.row+1,t.column+1]]:[[t.row-1,t.column-1],[t.row-1,t.column+1],[t.row+1,t.column-1],[t.row+1,t.column],[t.row+1,t.column+1]];return En(e.pos,n,t.piece)}(e,t);if(n===j||n===A||n===C||n===F||n===S||n===B||n===N||n===K||n===T||n===_)return function(e,t){if(!t.piece||t.piece!==j&&t.piece!==A&&t.piece!==C&&t.piece!==F&&t.piece!==S&&t.piece!==B&&t.piece!==N&&t.piece!==K&&t.piece!==T&&t.piece!==_)throw new Error("Called validation for kin(or promoted piece moves as same as kin), but piece id was not as expected.");if(-1===t.row&&-1===t.column)return gn(e.pos);var n=t.piece>0?[[t.row-1,t.column-1],[t.row-1,t.column],[t.row-1,t.column+1],[t.row,t.column-1],[t.row,t.column+1],[t.row+1,t.column]]:[[t.row-1,t.column],[t.row,t.column-1],[t.row,t.column+1],[t.row+1,t.column-1],[t.row+1,t.column],[t.row+1,t.column+1]];return En(e.pos,n,t.piece)}(e,t);if(n===g||n===D)return Sn(e,t);if(n===E||n===V)return Cn(e,t);if(n===x||n===z)return function(e,t){if(!t.piece||t.piece!==x&&t.piece!==z)throw new Error("Called validation for gyoku, but piece id was not gyoku.");if(-1===t.row&&-1===t.column)throw new Error("Gyoku must not be captured");var n=[[t.row-1,t.column-1],[t.row-1,t.column],[t.row-1,t.column+1],[t.row,t.column-1],[t.row,t.column+1],[t.row+1,t.column-1],[t.row+1,t.column],[t.row+1,t.column+1]];return En(e.pos,n,t.piece)}(e,t);if(n===R||n===W)return function(e,t){if(!t.piece||t.piece!==R&&t.piece!==W)throw new Error("Called validation for uma, but piece id was not uma.");if(-1===t.row||-1===t.column)throw new Error("Uma must not be captured");var n=[[t.row-1,t.column],[t.row,t.column-1],[t.row,t.column+1],[t.row+1,t.column]],r={row:t.row,column:t.column,piece:q(t.piece)},a=Sn(e,r),c=En(e.pos,n,t.piece).concat(a);return c.sort(We),c}(e,t);if(n===P||n===H)return function(e,t){if(!t.piece||t.piece!==P&&t.piece!==H)throw new Error("Called validation for ryu, but piece id was not ryu.");if(-1===t.row||-1===t.column)throw new Error("Ryu must not be captured");var n=[[t.row-1,t.column-1],[t.row-1,t.column+1],[t.row+1,t.column-1],[t.row+1,t.column+1]],r={row:t.row,column:t.column,piece:q(t.piece)},a=Cn(e,r),c=En(e.pos,n,t.piece).concat(a);return c.sort(We),c}(e,t);throw new Error("Could not get targets to move. Got invalid piece ID")},Tn=function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e.length;r++){var a=e[n][r];if(Math.abs(a)===x&&a*t>0)return{row:n,column:r,piece:a}}};function Rn(e,t,n,r){for(var a=0;a<e.pos.length;a++)for(var c=0;c<e.pos.length;c++){var o=e.pos[a][c];if(!(o*n<=0))if(-1!==He(Nn(e,{row:a,column:c,piece:o}),t)){if(r||Math.abs(o)!==x||t.piece&&Math.abs(t.piece)===x)return!0;if(!Rn(qt({pos:e,source:{row:a,column:c},dest:{row:t.row,column:t.column},piece:o}),t,-n,!0))return!0}}return!1}function Pn(){var e={pos:[[L,U,I,A,z,A,I,U,L],[d,D,d,d,d,d,d,V,d],[M,M,M,M,M,M,M,M,M],[d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d],[w,w,w,w,w,w,w,w,w],[d,E,d,d,d,d,d,g,d],[O,y,k,j,x,j,k,y,O]],cap0:[0,0,0,0,0,0,0],cap1:[0,0,0,0,0,0,0],turn:Je,moveCount:0};return{meta:{version:"1",player:{sente:"",gote:""},handicap:"\u5e73\u624b",initPos:e},history:{moves:[{index:0,str:"\u958b\u59cb\u5c40\u9762",pos:e,source:{row:0,column:0},dest:{row:0,column:0},piece:0}],index:0}}}var Mn,Ln,Un,In,An,Dn=(dn=function(){function e(){Object(l.a)(this,e),Object(Mt.a)(this,"indexes",wn,this),Object(Mt.a)(this,"selected",On,this),Object(Mt.a)(this,"confirm",yn,this),Object(Mt.a)(this,"moveTargets",kn,this),Object(Mt.a)(this,"kif",jn,this),this.indexes=[-1,0,1,2,3,4,5,6,7,8,9],this.selected=null,this.confirm=null,this.moveTargets=[],this.kif=Pn()}return Object(p.a)(e,[{key:"reverse",value:function(){this.indexes=this.indexes.slice().reverse()}},{key:"clickPiece",value:function(e){var t=this,n=this.selected,r=this.currentMove.pos.turn;if(!this.confirm||!Vn(e.clicked)){if(n&&Vn(e.clicked)&&function(e,t){return e.row===t.row&&e.column===t.column&&e.piece===t.clicked&&e.i===t.i}(n,e))return this.selected=null,void(this.moveTargets=[]);if(Vn(e.clicked)&&function(e,t){return e<0&&t===$e||e>0&&t===Je}(e.clicked,r)){var a={row:e.row,column:e.column,piece:e.clicked,i:e.i};this.selected=a;var c=Nn(this.currentMove.pos,a),o=function e(t,n,r){if(!n.piece)throw new Error("piece id is needed");for(var a=n.piece>0?Je:$e,c=Tn(t.pos,a),o=[],i=0;i<r.length;i++){var s=qt({pos:t,source:{row:n.row,column:n.column},dest:{row:r[i].row,column:r[i].column},piece:n.piece});if(n.piece&&Math.abs(n.piece)===x&&(c=Tn(s.pos,a)),void 0===c||!Rn(s,c,-a)){var u=Math.abs(n.piece)===w,l=-1===n.row,p=Tn(s.pos,-a);if(u&&l&&void 0!==p&&Rn(s,p,a)){var f=Rn(s,r[i],-a),h=e(s,p,Nn(s,p));if(!f&&0===h.length)continue}o.push(r[i])}}return o}(this.currentMove.pos,a,c);this.moveTargets=o}else{if(n&&n.piece)if(-1!==He(this.moveTargets,e)){var i={row:n.row,column:n.column},s={row:e.row,column:e.column},u=function(e,n){var r,a,c={pos:t.currentMove.pos,source:i,dest:s,piece:e,promote:n},o=Gt(c),u=Z(c),l={index:t.currentMove.index+1,str:u,pos:o,source:i,dest:s,piece:e,promote:n};t.selected=null,t.confirm=null,t.moveTargets=[],t.kif=(r=t.kif,a=l,{meta:r.meta,history:fn(r.history,a)})};if(Vn(e.clicked)){var l=J({sourceRow:n.row,destRow:e.row,piece:n.piece}),p=function(e,t){return(e===w||e===O)&&0===t||(e===M||e===L)&&8===t||e===y&&(0===t||1===t)||e===U&&(8===t||7===t)}(n.piece,e.row);if(!l||p)u(p?G(n.piece):n.piece,p||void 0);else this.confirm={promoted:G(n.piece),preserved:n.piece,row:e.row,column:e.column}}else{u(e.promote?e.clicked.promoted:e.clicked.preserved,!0===e.promote)}}}}}},{key:"clickKif",value:function(e,t){var n,r,a;this.confirm||(this.kif=(n=this.kif,r=e,a=t,{meta:n.meta,history:pn(n.history,r,a)}),this.selected=null,this.moveTargets=[])}},{key:"currentMove",get:function(){return function(e){for(var t=e.history,n=t.moves[t.index];Ze(n);)n=(t=n.branches[n.index]).moves[t.index];return n}(this.kif)}}]),e}(),wn=Object(Lt.a)(dn.prototype,"indexes",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),On=Object(Lt.a)(dn.prototype,"selected",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yn=Object(Lt.a)(dn.prototype,"confirm",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kn=Object(Lt.a)(dn.prototype,"moveTargets",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jn=Object(Lt.a)(dn.prototype,"kif",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(Lt.a)(dn.prototype,"currentMove",[Ut.e],Object.getOwnPropertyDescriptor(dn.prototype,"currentMove"),dn.prototype),Object(Lt.a)(dn.prototype,"reverse",[Ut.d],Object.getOwnPropertyDescriptor(dn.prototype,"reverse"),dn.prototype),Object(Lt.a)(dn.prototype,"clickPiece",[Ut.d],Object.getOwnPropertyDescriptor(dn.prototype,"clickPiece"),dn.prototype),Object(Lt.a)(dn.prototype,"clickKif",[Ut.d],Object.getOwnPropertyDescriptor(dn.prototype,"clickKif"),dn.prototype),dn);function Vn(e){return"number"===typeof e}var zn=new(Mn=function(){function e(){var t=this;Object(l.a)(this,e),Object(Mt.a)(this,"gameState",Ln,this),Object(Mt.a)(this,"engineState",Un,this),Object(Mt.a)(this,"displayState",In,this),Object(Mt.a)(this,"config",An,this),this.gameState=new Dn,this.engineState=new ln,this.displayState=new Vt,this.config=new Dt,this.engineState.setServerURL(this.config.serverURL),Object(Ut.m)(this.gameState,"currentMove",function(e){return t.updatePosition(e.newValue)}),Object(Ut.m)(this.config,"serverURL",function(e){return t.engineState.setServerURL(e.newValue)})}return Object(p.a)(e,[{key:"updatePosition",value:function(){var e=Object(Ee.a)(ge.a.mark(function e(t){var n;return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.engineState.state>=2){e.next=3;break}return e.abrupt("return");case 3:n=t||this.gameState.currentMove,this.engineState.updatePosition(n.pos);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}(),Ln=Object(Lt.a)(Mn.prototype,"gameState",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Un=Object(Lt.a)(Mn.prototype,"engineState",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),In=Object(Lt.a)(Mn.prototype,"displayState",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),An=Object(Lt.a)(Mn.prototype,"config",[Ut.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mn);u.a.render(i.a.createElement(c.a,{store:zn},i.a.createElement(mt,null)),document.getElementById("root")),new a.a(".Copy"),function(e){if("serviceWorker"in navigator){if(new URL("/shogi-board/playground",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/shogi-board/playground","/service-worker.js");vt?(function(e,t){fetch(e).then(function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):bt(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):bt(t,e)})}}()}},[[37,1,2]]]);
//# sourceMappingURL=main.f73f2d7e.chunk.js.map